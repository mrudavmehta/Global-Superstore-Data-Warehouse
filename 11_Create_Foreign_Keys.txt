USE Northwind_DW
Go

ALTER TABLE FACT_ORDERS
	ADD PRIMARY KEY (order_wk)
Go

ALTER TABLE DIM_CUSTOMER
	ADD FOREIGN KEY (geography_wk) REFERENCES DIM_GEOGRAPHY
Go

ALTER TABLE DIM_EMPLOYEE
	ADD FOREIGN KEY (geography_wk) REFERENCES DIM_GEOGRAPHY
Go

ALTER TABLE DIM_EMPLOYEE
	ADD FOREIGN KEY (direct_report_wk) REFERENCES DIM_EMPLOYEE
Go

ALTER TABLE DIM_PRODUCT
	ADD FOREIGN KEY (supplier_wk) REFERENCES DIM_SUPPLIER
Go

ALTER TABLE DIM_SUPPLIER
	ADD FOREIGN KEY (geography_wk) REFERENCES DIM_GEOGRAPHY
Go

ALTER TABLE FACT_ORDER_ITEMS
	ADD FOREIGN KEY (required_date_wk) REFERENCES DIM_CALENDAR
Go

ALTER TABLE FACT_ORDER_ITEMS
	ADD FOREIGN KEY (shipped_date_wk) REFERENCES DIM_CALENDAR
Go

ALTER TABLE FACT_ORDER_ITEMS
	ADD FOREIGN KEY (shipto_geography_wk) REFERENCES DIM_GEOGRAPHY
Go

ALTER TABLE FACT_ORDER_ITEMS
	ADD FOREIGN KEY (employee_wk) REFERENCES DIM_EMPLOYEE
Go

ALTER TABLE FACT_ORDER_ITEMS
	ADD FOREIGN KEY (customer_wk) REFERENCES DIM_CUSTOMER
Go

ALTER TABLE FACT_ORDER_ITEMS
	ADD FOREIGN KEY (product_wk) REFERENCES DIM_PRODUCT
Go

ALTER TABLE FACT_ORDER_ITEMS
	ADD FOREIGN KEY (shipper_wk) REFERENCES DIM_SHIPPER
Go

ALTER TABLE FACT_ORDER_ITEMS
	ADD FOREIGN KEY (order_date_wk) REFERENCES DIM_CALENDAR
Go

ALTER TABLE FACT_ORDERS
	ADD FOREIGN KEY (required_date_wk) REFERENCES DIM_CALENDAR
Go

ALTER TABLE FACT_ORDERS
	ADD FOREIGN KEY (shipped_date_wk) REFERENCES DIM_CALENDAR
Go

ALTER TABLE FACT_ORDERS
	ADD FOREIGN KEY (employee_wk) REFERENCES DIM_EMPLOYEE
Go

ALTER TABLE FACT_ORDERS
	ADD FOREIGN KEY (ship_to_geography_wk) REFERENCES DIM_GEOGRAPHY
Go


ALTER TABLE FACT_ORDERS
	ADD FOREIGN KEY (customer_wk) REFERENCES DIM_CUSTOMER
Go


ALTER TABLE FACT_ORDERS
	ADD FOREIGN KEY (shipper_wk) REFERENCES DIM_SHIPPER
Go


ALTER TABLE FACT_ORDERS
	ADD FOREIGN KEY (order_date_wk) REFERENCES DIM_CALENDAR
Go


